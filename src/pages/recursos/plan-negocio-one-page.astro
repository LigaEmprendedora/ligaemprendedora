---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";

const pageTitle = "Plan de Negocio One-Page | Liga Emprendedora";
const pageDescription =
  "Plantilla simple y accionable para definir tu estrategia de negocio en una sola hoja. Dise√±ada para emprendedores de LATAM que quieren claridad r√°pida sin tanta teor√≠a.";
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <div class="flex min-h-screen flex-col bg-[#f4f6fa]">
    <Header />

    <main class="flex-1">
      <section class="w-full px-4 py-16 md:px-6 md:py-20">
        <div class="mx-auto max-w-4xl">
          <!-- T√≠tulo -->
          <p class="text-xs font-semibold uppercase tracking-[0.25em] text-[#162741]">
            Recursos ¬∑ Plantilla
          </p>
          <h1 class="mt-3 text-3xl md:text-4xl font-extrabold text-[#162741]">
            Plan de Negocio One-Page
          </h1>
          <p class="mt-3 text-base md:text-lg text-[#162741]">
            Define tu estrategia en una sola hoja. Esta plantilla te ayuda a aterrizar objetivo,
            cliente ideal, propuesta de valor, modelo de negocio, canales y m√©tricas clave
            sin perderte en un documento de 30 p√°ginas.
          </p>

          <!-- Bloque contenido -->
          <div class="mt-10 grid gap-8 md:grid-cols-[2fr,1.4fr]">
            <!-- Descripci√≥n detallada -->
            <div class="rounded-3xl border border-[#f0eaea] bg-white p-6 shadow-sm">
              <h2 class="text-lg md:text-xl font-semibold text-[#162741]">
                ¬øQu√© incluye esta plantilla?
              </h2>
              <ul class="mt-4 space-y-2 text-sm text-[#162741]">
                <li>‚Ä¢ Objetivo del partido (meta a 90 d√≠as).</li>
                <li>‚Ä¢ Cliente ideal y problema central.</li>
                <li>‚Ä¢ Propuesta de valor y MVP.</li>
                <li>‚Ä¢ Modelo de negocio y canales de venta.</li>
                <li>‚Ä¢ KPIs clave para seguir el marcador.</li>
                <li>‚Ä¢ Pr√≥ximas jugadas claras para los pr√≥ximos 7 d√≠as.</li>
              </ul>

              <p class="mt-5 text-sm text-[#6b7280]">
                Formato ideal para imprimir, usar en equipo o revisar cada semana como
                tu t√°ctica de partido.
              </p>
            </div>

            <!-- Formulario + descarga -->
            <div class="rounded-3xl border border-[#f0eaea] bg-white p-6 shadow-sm">
              <h3 class="text-base font-semibold text-[#162741]">
                üéüÔ∏è Accede al recurso gratis
              </h3>
              <p class="mt-2 text-xs md:text-sm text-[#4b5563]">
                D√©janos tus datos y te mostraremos el enlace de descarga. Tambi√©n podr√°s
                recibir otros recursos y novedades de la Liga.
              </p>

              <form
                class="mt-5 space-y-3"
                name="plan-negocio-one-page"
                method="POST"
                data-netlify="true"
                netlify-honeypot="bot-field"
                data-download-link="https://docs.google.com/spreadsheets/d/15rGW4_qT589XpPr6FhJ98K0F8QaZ9rJ6-xhIRWYugU0/edit?usp=sharing"
                >
                                <input type="hidden" name="form-name" value="plan-negocio-one-page" />
                <p class="hidden">
                    <label>
                    No llenar:
                    <input name="bot-field" />
                    </label>
                </p>

                <div>
                  <label class="block text-xs font-semibold text-[#4b5563]">
                    Nombre completo*
                  </label>
                  <input
                    type="text"
                    name="nombre"
                    required
                    class="mt-1 w-full rounded-2xl border border-[#e5e7eb] px-3 py-2 text-sm outline-none focus:border-[#162741]"
                  />
                </div>

                <div>
                  <label class="block text-xs font-semibold text-[#4b5563]">
                    Email*
                  </label>
                  <input
                    type="email"
                    name="email"
                    required
                    class="mt-1 w-full rounded-2xl border border-[#e5e7eb] px-3 py-2 text-sm outline-none focus:border-[#162741]"
                  />
                </div>

                <div>
                  <label class="block text-xs font-semibold text-[#4b5563]">
                    Nombre de la empresa
                  </label>
                  <input
                    type="text"
                    name="empresa"
                    class="mt-1 w-full rounded-2xl border border-[#e5e7eb] px-3 py-2 text-sm outline-none focus:border-[#162741]"
                  />
                </div>

                <div>
                  <label class="block text-xs font-semibold text-[#4b5563]">
                    Tel√©fono
                  </label>
                  <input
                    type="tel"
                    name="telefono"
                    class="mt-1 w-full rounded-2xl border border-[#e5e7eb] px-3 py-2 text-sm outline-none focus:border-[#162741]"
                  />
                </div>

                <button
                    type="submit"
                    class="mt-2 inline-flex w-full items-center justify-center rounded-full bg-[#162741] px-5 py-2.5 text-sm font-semibold text-white shadow-md transition hover:bg-[#c23a26]"
                >
                    Quiero descargar este recurso
                </button>

                <p class="mt-2 text-[11px] text-[#6b7280]">
                    Despu√©s de enviar el formulario ver√°s el enlace de descarga.
                </p>

                <!-- Mensaje de descarga (lo rellenaremos por JS) -->
                <div
                    class="mt-4 hidden rounded-2xl bg-[#ecfdf3] px-4 py-3 text-xs text-[#14532d]"
                    data-download-message
                >
<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    // TU URL completa de Google Apps Script /exec
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz4BZPlvEa1-78yTjp6nBdGH9-UCP02lK2VRrFUA7iSX4It2ODw6nR0_TsMmxabTD52tg/exec";

    // Selecciona todos los formularios con atributo name
    const forms = document.querySelectorAll("form[name]");

    forms.forEach((form) => {
      form.addEventListener("submit", async (event) => {
        event.preventDefault(); // evitamos el reload autom√°tico

        const formData = new FormData(form);

        // -----------------------------------------
        // 1) Enviar a Netlify
        // -----------------------------------------
        const netlifyBody = new URLSearchParams(formData).toString();

        fetch("/", {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: netlifyBody,
        }).catch((err) =>
          console.error("Error enviando a Netlify:", err)
        );

        // -----------------------------------------
        // 2) Enviar a Google Sheets (Apps Script)
        // -----------------------------------------
        if (SCRIPT_URL) {
          fetch(SCRIPT_URL, {
            method: "POST",
            mode: "no-cors",
            body: formData,
          }).catch((err) =>
            console.error("Error enviando a Sheets:", err)
          );
        }

        // -----------------------------------------
        // 3) Mostrar mensaje de descarga
        // -----------------------------------------
        const downloadLink = form.dataset.downloadLink;
        const messageEl = form.querySelector("[data-download-message]");

        if (downloadLink && messageEl) {
          messageEl.innerHTML = `
            üéÅ <strong>¬°Listo! Tu recurso est√° disponible.</strong><br/><br/>
            <a 
              href="${downloadLink}" 
              target="_blank" 
              rel="noopener" 
              class="underline font-semibold text-[#0a6a30]"
            >üëâ Haz clic aqu√≠ para descargarlo</a>
          `;

          messageEl.classList.remove("hidden");
        }

        // -----------------------------------------
        // 4) Limpiar el formulario (opcional)
        // -----------------------------------------
        form.reset();
      });
    });
  });
</script>
                </div>
                </form>

              <!-- Bloque descarga (puedes mostrarlo en la p√°gina de gracias) -->
           
            </div>
          </div>
        </div>
      </section>
    </main>

    <Footer />
  </div>
</BaseLayout>
